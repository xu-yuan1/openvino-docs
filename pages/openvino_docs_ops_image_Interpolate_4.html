
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Interpolate &#8212; OpenVINO™  documentation</title>
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/doxyrest-pygments.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <link href="../_static/css/media/favicon.ico" rel="shortcut icon">
    <link rel="stylesheet" href="../_static/css/openvino_sphinx_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/button.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/input.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/textfield.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/tabs.css" type="text/css" />
    <script src="../_static/js/openvino_sphinx_theme.js"></script>
    <link rel="stylesheet" href="../_static/css/viewer.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-barchart-background@1.3.0/build/Plugin.Barchart.Background.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-deferred@1"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
    <script src="../_static/js/viewer.min.js"></script>
    <script src="/assets/versions_raw.js"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/custom.js"></script>
    <script src="../_static/js/graphs.js"></script>
    <script src="../_static/js/graphs_ov_tf.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/target-highlight.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <link rel="canonical" href="https://docs.openvino.ai/latest/pages/openvino_docs_ops_image_Interpolate_4.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LRN" href="openvino_docs_ops_normalization_LRN_1.html" />
    <link rel="prev" title="Interpolate" href="openvino_docs_ops_image_Interpolate_1.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
      <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="get_started.html">
  Get Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="documentation.html">
  Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api/api_reference.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../model_zoo.html">
  Model Zoo
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="resources.html">
  Resources
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openvinotoolkit/openvino" rel="noopener" target="_blank" title="GitHub">
            <span><i class="sst-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
</ul>
      </div>
      
      <div class="navbar-end-item">
        
<div class="dropdown sst-dropdown sst-dropdown-navbar">
  <button class="btn sst-btn dropdown-toggle" type="button" id="version-selector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
  <div class="dropdown-menu" aria-labelledby="version-selector">
  </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        

<div class="dropdown sst-dropdown sst-dropdown-navbar">
  <button class="btn sst-btn dropdown-toggle" type="button" id="language-selector" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">English</button>
  <div class="dropdown-menu" aria-labelledby="language-selector">
    
      
        <a class="dropdown-item font-weight-bold" href="/latest/pages/openvino_docs_ops_image_Interpolate_4.html">English</a>
      
    
      
        <a  class="dropdown-item" href="/cn/latest/pages/openvino_docs_ops_image_Interpolate_4.html">Chinese</a>
      
    
  </div>
</div>

      </div>
      
    </div>
  </div>
</div>
        <div id="collapse-nav-wrapper" class="container-xl">
          <button id="collapse-nav" class="button bttn-prm button-size-m" type="button" data-toggle="collapse" data-target="#nav-tree" aria-expanded="false" aria-controls="nav-tree">
            Documentation navigation <i class="fas fa-chevron-down"></i>
          </button>
        </div>
      </nav>
      <div class="transition-banner container-fluid alert alert-info alert-dismissible fade show" role="alert">
        <p>OpenVINO 2022.1 introduces a new version of OpenVINO API (API 2.0). For more information on the changes and transition steps, see the <a href="https://docs.openvino.ai/latest/openvino_2_0_transition_guide.html">transition guide</a></p>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
    </div>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar" id="nav-tree"><form class="searchForm bd-search d-flex align-items-center" action="../search.html" method="get">
    <i class="icon fas fa-search"></i>
    <input type="search" class="form-control" name="query" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Additional Resources
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://software.intel.com/content/www/us/en/develop/articles/openvino-relnotes.html">
   Release Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_OV_UG_supported_plugins_Supported_Devices.html">
   Supported Devices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_MO_DG_prepare_model_Supported_Frameworks_Layers.html">
   Supported Framework Layers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_OV_Glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_Legal_Information.html">
   Legal Information
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Intermediate Representation and Operations Sets
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_MO_DG_IR_and_opsets.html">
   Deep Learning Network Intermediate Representation and Operation Sets in OpenVINO™
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="openvino_docs_ops_opset.html">
   Available Operations Sets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset9.html">
     opset9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset8.html">
     opset8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset7.html">
     opset7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset6.html">
     opset6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset5.html">
     opset5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset4.html">
     opset4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset3.html">
     opset3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset2.html">
     opset2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_opset1.html">
     opset1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_ops_broadcast_rules.html">
   Broadcast Rules For Elementwise Operations
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="openvino_docs_operations_specifications.html">
   Operations Specifications
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Abs_1.html">
     Abs-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Acos_1.html">
     Acos-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Acosh_3.html">
     Acosh-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_pooling_AdaptiveAvgPool_8.html">
     AdaptiveAvgPool-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_pooling_AdaptiveMaxPool_8.html">
     AdaptiveMaxPool-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Add_1.html">
     Add-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Asin_1.html">
     Asin-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Asinh_3.html">
     Asinh-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_Assign_3.html">
     Assign-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Atan_1.html">
     Atan-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Atanh_3.html">
     Atanh-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_pooling_AvgPool_1.html">
     AvgPool-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_BatchNormInference_1.html">
     BatchNormInference-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_BatchNormInference_5.html">
     BatchNormInference-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_BatchToSpace_2.html">
     BatchToSpace-2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_BinaryConvolution_1.html">
     BinaryConvolution-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Broadcast_1.html">
     Broadcast-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Broadcast_3.html">
     Broadcast-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_condition_Bucketize_3.html">
     Bucketize-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_CTCGreedyDecoder_1.html">
     CTCGreedyDecoder-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_CTCGreedyDecoderSeqLen_6.html">
     CTCGreedyDecoderSeqLen-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Ceiling_1.html">
     Ceiling-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Clamp_1.html">
     Clamp-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Concat_1.html">
     Concat-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_Constant_1.html">
     Constant-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_type_ConvertLike_1.html">
     ConvertLike-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_type_Convert_1.html">
     Convert-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_ConvolutionBackpropData_1.html">
     ConvolutionBackpropData-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_Convolution_1.html">
     Convolution-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Cos_1.html">
     Cos-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Cosh_1.html">
     Cosh-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_CTCLoss_4.html">
     CTCLoss-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_CumSum_3.html">
     CumSum-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_DeformableConvolution_1.html">
     DeformableConvolution-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_DeformableConvolution_8.html">
     DeformableConvolution-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_DeformablePSROIPooling_1.html">
     DeformablePSROIPooling-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_DepthToSpace_1.html">
     DepthToSpace-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_DetectionOutput_1.html">
     DetectionOutput-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_DetectionOutput_8.html">
     DetectionOutput-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_signals_DFT_7.html">
     DFT-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Divide_1.html">
     Divide-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_matrix_Einsum_7.html">
     Einsum-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Elu_1.html">
     Elu-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sparse_EmbeddingBagOffsetsSum_3.html">
     EmbeddingBagOffsetsSum-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sparse_EmbeddingBagPackedSum_3.html">
     EmbeddingBagPackedSum-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sparse_EmbeddingSegmentsSum_3.html">
     EmbeddingSegmentsSum-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_Equal_1.html">
     Equal-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Erf_1.html">
     Erf-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Exp_1.html">
     Exp-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ExperimentalDetectronDetectionOutput_6.html">
     ExperimentalDetectronDetectionOutput-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ExperimentalDetectronGenerateProposalsSingleImage_6.html">
     ExperimentalDetectronGenerateProposalsSingleImage-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ExperimentalDetectronPriorGridGenerator_6.html">
     ExperimentalDetectronPriorGridGenerator-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ExperimentalDetectronROIFeatureExtractor_6.html">
     ExperimentalDetectronROIFeatureExtractor-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_ExperimentalDetectronTopKROIs_6.html">
     ExperimentalDetectronTopKROIs-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ExtractImagePatches_3.html">
     ExtractImagePatches-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_generation_Eye_9.html">
     Eye-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_quantization_FakeQuantize_1.html">
     FakeQuantize-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_FloorMod_1.html">
     FloorMod-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Floor_1.html">
     Floor-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_GridSample_9.html">
     GridSample-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_GRN_1.html">
     GRN-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_GRUCell_3.html">
     GRUCell-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_GRUSequence_5.html">
     GRUSequence-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_GatherTree_1.html">
     GatherTree-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Gather_1.html">
     Gather-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Gather_7.html">
     Gather-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Gather_8.html">
     Gather-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_GatherElements_6.html">
     GatherElements-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_GatherND_5.html">
     GatherND-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_GatherND_8.html">
     GatherND-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_GELU_2.html">
     GELU-2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_GELU_7.html">
     GELU-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_GenerateProposals_9.html">
     GenerateProposals-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_GreaterEqual_1.html">
     GreaterEqual-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_Greater_1.html">
     Greater-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_GroupConvolutionBackpropData_1.html">
     GroupConvolutionBackpropData-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_convolution_GroupConvolution_1.html">
     GroupConvolution-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_HardSigmoid_1.html">
     HardSigmoid-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_HSigmoid_5.html">
     HSigmoid-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_HSwish_4.html">
     HSwish-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_I420toBGR_8.html">
     I420toBGR-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_I420toRGB_8.html">
     I420toRGB-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_signals_IDFT_7.html">
     IDFT-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_signals_IRDFT_9.html">
     IRDFT-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_If_8.html">
     If-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_Interpolate_1.html">
     Interpolate-1
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Interpolate-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_LRN_1.html">
     LRN-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_LSTMCell_1.html">
     LSTMCell-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_LSTMSequence_1.html">
     LSTMSequence-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_LessEqual_1.html">
     LessEqual-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_Less_1.html">
     Less-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Log_1.html">
     Log-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_logical_LogicalAnd_1.html">
     LogicalAnd-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_logical_LogicalNot_1.html">
     LogicalNot-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_logical_LogicalOr_1.html">
     LogicalOr-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_logical_LogicalXor_1.html">
     LogicalXor-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_LogSoftmax_5.html">
     LogSoftmax-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_Loop_5.html">
     Loop-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_MVN_1.html">
     MVN-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_MVN_6.html">
     MVN-6
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_matrix_MatMul_1.html">
     MatMul-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_MatrixNms_8.html">
     MatrixNms-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_pooling_MaxPool_1.html">
     MaxPool-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_pooling_MaxPool_8.html">
     MaxPool-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Maximum_1.html">
     Maximum-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Minimum_1.html">
     Minimum-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Mish_4.html">
     Mish-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Mod_1.html">
     Mod-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_MulticlassNonMaxSuppression_8.html">
     MulticlassNonMaxSuppression-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_MulticlassNonMaxSuppression_9.html">
     MulticlassNonMaxSuppression-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Multiply_1.html">
     Multiply-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Negative_1.html">
     Negative-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_NonMaxSuppression_1.html">
     NonMaxSuppression-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_NonMaxSuppression_3.html">
     NonMaxSuppression-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_NonMaxSuppression_4.html">
     NonMaxSuppression-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_NonMaxSuppression_5.html">
     NonMaxSuppression-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_NonMaxSuppression_9.html">
     NonMaxSuppression-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_condition_NonZero_3.html">
     NonZero-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_normalization_NormalizeL2_1.html">
     NormalizeL2-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_comparison_NotEqual_1.html">
     NotEqual-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_NV12toBGR_8.html">
     NV12toBGR-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_image_NV12toRGB_8.html">
     NV12toRGB-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_OneHot_1.html">
     OneHot-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_PReLU_1.html">
     PReLU-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_PSROIPooling_1.html">
     PSROIPooling-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Pad_1.html">
     Pad-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_Parameter_1.html">
     Parameter-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Power_1.html">
     Power-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_PriorBoxClustered_1.html">
     PriorBoxClustered-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_PriorBox_1.html">
     PriorBox-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_PriorBox_8.html">
     PriorBox-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_Proposal_1.html">
     Proposal-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_Proposal_4.html">
     Proposal-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_generation_RandomUniform_8.html">
     RandomUniform-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_generation_Range_1.html">
     Range-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_generation_Range_4.html">
     Range-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_signals_RDFT_9.html">
     RDFT-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_ReadValue_3.html">
     ReadValue-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_ReLU_1.html">
     ReLU-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceL1_4.html">
     ReduceL1-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceL2_4.html">
     ReduceL2-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceLogicalAnd_1.html">
     ReduceLogicalAnd-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceLogicalOr_1.html">
     ReduceLogicalOr-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceMax_1.html">
     ReduceMax-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceMean_1.html">
     ReduceMean-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceMin_1.html">
     ReduceMin-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceProd_1.html">
     ReduceProd-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_reduction_ReduceSum_1.html">
     ReduceSum-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_RegionYolo_1.html">
     RegionYolo-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ReorgYolo_1.html">
     ReorgYolo-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_shape_Reshape_1.html">
     Reshape-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_Result_1.html">
     Result-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Reverse_1.html">
     Reverse-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ReverseSequence_1.html">
     ReverseSequence-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_RNNCell_3.html">
     RNNCell-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sequence_RNNSequence_5.html">
     RNNSequence-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ROIAlign_3.html">
     ROIAlign-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ROIAlign_9.html">
     ROIAlign-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_detection_ROIPooling_1.html">
     ROIPooling-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Roll_7.html">
     Roll-7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Round_5.html">
     Round-5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ScatterElementsUpdate_3.html">
     ScatterElementsUpdate-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ScatterNDUpdate_3.html">
     ScatterNDUpdate-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ScatterUpdate_3.html">
     ScatterUpdate-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_condition_Select_1.html">
     Select-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Selu_1.html">
     Selu-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_shape_ShapeOf_1.html">
     ShapeOf-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_shape_ShapeOf_3.html">
     ShapeOf-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_ShuffleChannels_1.html">
     ShuffleChannels-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Sigmoid_1.html">
     Sigmoid-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Sign_1.html">
     Sign-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Sin_1.html">
     Sin-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Sinh_1.html">
     Sinh-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Slice_8.html">
     Slice-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_SoftMax_1.html">
     SoftMax-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_SoftMax_8.html">
     SoftMax-8
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_SoftPlus_4.html">
     SoftPlus-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_SoftSign_9.html">
     SoftSign-9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_SpaceToBatch_2.html">
     SpaceToBatch-2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_SpaceToDepth_1.html">
     SpaceToDepth-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Split_1.html">
     Split-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Sqrt_1.html">
     Sqrt-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_SquaredDifference_1.html">
     SquaredDifference-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_shape_Squeeze_1.html">
     Squeeze-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_StridedSlice_1.html">
     StridedSlice-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Subtract_1.html">
     Subtract-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_activation_Swish_4.html">
     Swish-4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Tan_1.html">
     Tan-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_arithmetic_Tanh_1.html">
     Tanh-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_infrastructure_TensorIterator_1.html">
     TensorIterator-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Tile_1.html">
     Tile-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_TopK_1.html">
     TopK-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_sort_TopK_3.html">
     TopK-3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_Transpose_1.html">
     Transpose-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_shape_Unsqueeze_1.html">
     Unsqueeze-1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="openvino_docs_ops_movement_VariadicSplit_1.html">
     VariadicSplit-1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openvino_docs_MO_DG_prepare_model_convert_model_IR_suitable_for_INT8_inference.html">
   Intermediate Representation Suitable for INT8 Inference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Case Studies
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference external" href="https://www.intel.com/openvino-success-stories">
   Case Studies
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                <div class="tocsection download-docs">
  <div class="dropdown sst-dropdown">
    <button class="button bttn-prm button-size-m" data-display="static" type="button" id="download-options"
      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
      Download Docs
    </button>
    <div class="dropdown-menu" aria-labelledby="download-options">
      <a class="dropdown-item" href="#" onclick="window.print()">.pdf</a>
      <a id="download-zip-btn" class="dropdown-item" href="#">.zip</a>
    </div>
  </div>
</div>
              </div>
              
            
          </div>
          

          
          
              
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">

<div class="tocsection editthispage">
    <a href="None">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

            
                <div>
                  
  <section id="interpolate">
<span id="doxid-openvino-docs-ops-image-interpolate-4"></span><span id="index-0"></span><h1>Interpolate<a class="headerlink" href="#interpolate" title="Permalink to this headline">¶</a></h1>
<p><span class="target" id="doxid-openvino-docs-ops-image-interpolate-4-1md-openvino-docs-ops-image-interpolate-4"></span> <strong>Versioned name</strong> : <em>Interpolate-4</em></p>
<p><strong>Category</strong> : <em>Image processing</em></p>
<p><strong>Short description</strong> : <em>Interpolate</em> layer performs interpolation of independent slices in input tensor by specified dimensions and attributes.</p>
<p><strong>Attributes</strong></p>
<ul class="simple">
<li><p><em>mode</em></p>
<ul>
<li><p><strong>Description</strong> : specifies type of interpolation</p></li>
<li><p><strong>Range of values</strong> : one of <code class="docutils literal notranslate"><span class="pre">nearest</span></code>, <code class="docutils literal notranslate"><span class="pre">linear</span></code>, <code class="docutils literal notranslate"><span class="pre">linear_onnx</span></code>, <code class="docutils literal notranslate"><span class="pre">cubic</span></code></p></li>
<li><p><strong>Type</strong> : string</p></li>
<li><p><strong>Required</strong> : <em>yes</em> <strong>Note</strong> : Only 2D, 3D, 4D, 5D tensors with <code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">1}</span></code>, <code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">2}</span></code>, <code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">=</span> <span class="pre">{2,</span> <span class="pre">3}</span></code>, <code class="docutils literal notranslate"><span class="pre">axes</span> <span class="pre">=</span> <span class="pre">{2,</span> <span class="pre">3,</span> <span class="pre">4}</span></code> respectively are supported for <code class="docutils literal notranslate"><span class="pre">&quot;mode&quot;</span> <span class="pre">==</span> <span class="pre">&quot;linear_onnx&quot;</span></code>.</p></li>
</ul>
</li>
<li><p><em>shape_calculation_mode</em></p>
<ul>
<li><p><strong>Description</strong> : specifies which input, <code class="docutils literal notranslate"><span class="pre">sizes</span></code> or <code class="docutils literal notranslate"><span class="pre">scales</span></code>, is used to calculate an output shape.</p></li>
<li><p><strong>Range of values</strong> : name of a shape calculation mode in string format:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sizes</span></code> - an output shape is calculated as <code class="docutils literal notranslate"><span class="pre">output_shape[axes[i]]</span> <span class="pre">=</span> <span class="pre">sizes[i]</span></code> for all <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(0,</span> <span class="pre">len(axes))</span></code> and <code class="docutils literal notranslate"><span class="pre">output_shape[j]</span> <span class="pre">=</span> <span class="pre">input_shape[j]</span> <span class="pre">+</span> <span class="pre">pads_begin[j]</span> <span class="pre">+</span> <span class="pre">pads_end[j]</span></code> for <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">axes</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">in</span> <span class="pre">range(0,</span> <span class="pre">rank(data))</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scales</span></code> - an output shape is calculated as <code class="docutils literal notranslate"><span class="pre">output_shape[axes[i]]</span> <span class="pre">=</span> <span class="pre">floor(scales[i]</span> <span class="pre">\*</span> <span class="pre">(input_shape[axes[i]]</span> <span class="pre">+</span> <span class="pre">pads_begin[axes[i]]</span> <span class="pre">+</span> <span class="pre">pads_end[axes[i]]))</span></code> for all <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(0,</span> <span class="pre">len(axes))</span></code> and <code class="docutils literal notranslate"><span class="pre">output_shape[j]</span> <span class="pre">=</span> <span class="pre">input_shape[j]</span> <span class="pre">+</span> <span class="pre">pads_begin[j]</span> <span class="pre">+</span> <span class="pre">pads_end[j]</span></code> for <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">not</span> <span class="pre">in</span> <span class="pre">axes</span></code>, <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">in</span> <span class="pre">range(0,</span> <span class="pre">rank(data))</span></code></p></li>
</ul>
</li>
<li><p><strong>Type</strong> : string</p></li>
<li><p><strong>Required</strong> : <em>yes</em></p></li>
</ul>
</li>
<li><p><em>coordinate_transformation_mode</em></p>
<ul>
<li><p><strong>Description</strong> : specifies how to transform the coordinate in the resized tensor to the coordinate in the original tensor</p></li>
<li><p><strong>Range of values</strong> : name of the transformation mode in string format (here <code class="docutils literal notranslate"><span class="pre">scale[x]</span></code> is <code class="docutils literal notranslate"><span class="pre">output_shape[x]</span> <span class="pre">/</span> <span class="pre">input_shape[x]</span></code> and <code class="docutils literal notranslate"><span class="pre">x_resized</span></code> is a coordinate in axis <code class="docutils literal notranslate"><span class="pre">x</span></code>, for any axis <code class="docutils literal notranslate"><span class="pre">x</span></code> from the input <code class="docutils literal notranslate"><span class="pre">axes</span></code>):</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">half_pixel</span></code> - the coordinate in the original tensor axis <code class="docutils literal notranslate"><span class="pre">x</span></code> is calculated as <code class="docutils literal notranslate"><span class="pre">((x_resized</span> <span class="pre">+</span> <span class="pre">0.5)</span> <span class="pre">/</span> <span class="pre">scale[x])</span> <span class="pre">-</span> <span class="pre">0.5</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pytorch_half_pixel</span></code> - the coordinate in the original tensor axis <code class="docutils literal notranslate"><span class="pre">x</span></code> is calculated by <code class="docutils literal notranslate"><span class="pre">(x_resized</span> <span class="pre">+</span> <span class="pre">0.5)</span> <span class="pre">/</span> <span class="pre">scale[x]</span> <span class="pre">-</span> <span class="pre">0.5</span> <span class="pre">if</span> <span class="pre">output_shape[x]</span> <span class="pre">&gt;</span> <span class="pre">1</span> <span class="pre">else</span> <span class="pre">0.0</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">asymmetric</span></code> - the coordinate in the original tensor axis <code class="docutils literal notranslate"><span class="pre">x</span></code> is calculated according to the formula <code class="docutils literal notranslate"><span class="pre">x_resized</span> <span class="pre">/</span> <span class="pre">scale[x]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf_half_pixel_for_nn</span></code> - the coordinate in the original tensor axis <code class="docutils literal notranslate"><span class="pre">x</span></code> is <code class="docutils literal notranslate"><span class="pre">(x_resized</span> <span class="pre">+</span> <span class="pre">0.5)</span> <span class="pre">/</span> <span class="pre">scale[x]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">align_corners</span></code> - the coordinate in the original tensor axis <code class="docutils literal notranslate"><span class="pre">x</span></code> is calculated as <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">if</span> <span class="pre">output_shape[x]</span> <span class="pre">==</span> <span class="pre">1</span> <span class="pre">else</span> <span class="pre">x_resized</span> <span class="pre">\*</span> <span class="pre">(input_shape[x]</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">/</span> <span class="pre">(output_shape[x]</span> <span class="pre">-</span> <span class="pre">1)</span></code>.</p></li>
</ul>
</li>
<li><p><strong>Type</strong> : string</p></li>
<li><p><strong>Default value</strong> : <code class="docutils literal notranslate"><span class="pre">half_pixel</span></code></p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
<li><p><em>nearest_mode</em></p>
<ul>
<li><p><strong>Description</strong> : specifies round mode when <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">nearest</span></code> and is used only when <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">nearest</span></code>.</p></li>
<li><p><strong>Range of values</strong> : name of the round mode in string format:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">round_prefer_floor</span></code> - this mode is known as round half down.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">round_prefer_ceil</span></code> - it is round half up mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">floor</span></code> - this mode computes the largest integer value not greater than rounded value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ceil</span></code> - this mode computes the smallest integer value not less than rounded value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">simple</span></code> - this mode behaves as <code class="docutils literal notranslate"><span class="pre">ceil</span></code> mode when <code class="docutils literal notranslate"><span class="pre">Interpolate</span></code> is downsample, and as dropping the fractional part otherwise.</p></li>
</ul>
</li>
<li><p><strong>Type</strong> : string</p></li>
<li><p><strong>Default value</strong> : <code class="docutils literal notranslate"><span class="pre">round_prefer_floor</span></code></p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
<li><p><em>antialias</em></p>
<ul>
<li><p><strong>Description</strong> : <em>antialias</em> is a flag that specifies whether to perform anti-aliasing.</p></li>
<li><p><strong>Range of values</strong> :</p>
<ul>
<li><p>false - do not perform anti-aliasing</p></li>
<li><p>true - perform anti-aliasing</p></li>
</ul>
</li>
<li><p><strong>Type</strong> : boolean</p></li>
<li><p><strong>Default value</strong> : false</p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
<li><p><em>pads_begin</em></p>
<ul>
<li><p><strong>Description</strong> : <em>pads_begin</em> specifies the number of pixels to add to the beginning of the image being interpolated. This addition of pixels is done before interpolation calculation.</p></li>
<li><p><strong>Range of values</strong> : list of non-negative integer numbers</p></li>
<li><p><strong>Type</strong> : <code class="docutils literal notranslate"><span class="pre">int[]</span></code></p></li>
<li><p><strong>Default value</strong> : <code class="docutils literal notranslate"><span class="pre">[0]</span></code></p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
<li><p><em>pads_end</em></p>
<ul>
<li><p><strong>Description</strong> : <em>pads_end</em> specifies the number of pixels to add to the end of the image being interpolated. This addition of pixels is done before interpolation calculation.</p></li>
<li><p><strong>Range of values</strong> : list of non-negative integer numbers</p></li>
<li><p><strong>Type</strong> : <code class="docutils literal notranslate"><span class="pre">int[]</span></code></p></li>
<li><p><strong>Default value</strong> : <code class="docutils literal notranslate"><span class="pre">[0]</span></code></p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
<li><p><em>cube_coeff</em></p>
<ul>
<li><p><strong>Description</strong> : <em>cube_coeff</em> specifies the parameter <em>a</em> for cubic interpolation (see, e.g. <a class="reference external" href="https://ieeexplore.ieee.org/document/1163711/">article</a>). <em>cube_coeff</em> is used only when <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">cubic</span></code>.</p></li>
<li><p><strong>Range of values</strong> : floating-point number</p></li>
<li><p><strong>Type</strong> : any of supported floating-point type</p></li>
<li><p><strong>Default value</strong> : <code class="docutils literal notranslate"><span class="pre">-0.75</span></code></p></li>
<li><p><strong>Required</strong> : <em>no</em></p></li>
</ul>
</li>
</ul>
<p><strong>Inputs</strong></p>
<ul class="simple">
<li><p><strong>1</strong> : <code class="docutils literal notranslate"><span class="pre">data</span></code> - tensor of type <em>T</em> with data for interpolation. <strong>Required.</strong></p></li>
<li><p><strong>2</strong> : <code class="docutils literal notranslate"><span class="pre">sizes</span></code> - 1D tensor of type <em>T_SIZE</em> describing output shape for spatial axes. Number of elements matches the number of indices in <code class="docutils literal notranslate"><span class="pre">axes</span></code> input, the order matches as well. <strong>Required.</strong></p></li>
<li><p><strong>3</strong> : <code class="docutils literal notranslate"><span class="pre">scales</span></code> - 1D tensor of type <em>T_SCALES</em> describing scales for spatial axes. Number and order of elements match the number and order of indices in <code class="docutils literal notranslate"><span class="pre">axes</span></code> input. <strong>Required.</strong></p></li>
<li><p><strong>4</strong> : <code class="docutils literal notranslate"><span class="pre">axes</span></code> - 1D tensor of type <em>T_AXES</em> specifying dimension indices where interpolation is applied, and <code class="docutils literal notranslate"><span class="pre">axes</span></code> is any unordered list of indices of different dimensions of input tensor, e.g. <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">4]</span></code>, <code class="docutils literal notranslate"><span class="pre">[4,</span> <span class="pre">0]</span></code>, <code class="docutils literal notranslate"><span class="pre">[4,</span> <span class="pre">2,</span> <span class="pre">1]</span></code>, <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>. These indices should be non-negative integers from <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">rank(data)</span> <span class="pre">-</span> <span class="pre">1</span></code> inclusively. Other dimensions do not change. The order of elements in <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute matters, and mapped directly to elements in the 2nd input <code class="docutils literal notranslate"><span class="pre">sizes</span></code>. <strong>Optional</strong> with default value <code class="docutils literal notranslate"><span class="pre">[0,...,rank(data)</span> <span class="pre">-</span> <span class="pre">1]</span></code>.</p></li>
</ul>
<p><strong>Outputs</strong></p>
<ul class="simple">
<li><p><strong>1</strong> : Resulting interpolated tensor with elements of the same type as input <code class="docutils literal notranslate"><span class="pre">data</span></code> tensor. The shape of the output matches input <code class="docutils literal notranslate"><span class="pre">data</span></code> shape except spatial dimensions mentioned in <code class="docutils literal notranslate"><span class="pre">axes</span></code> attribute. For other dimensions shape matches sizes from <code class="docutils literal notranslate"><span class="pre">sizes</span></code> in order specified in <code class="docutils literal notranslate"><span class="pre">axes</span></code>.</p></li>
</ul>
<p><strong>Types</strong></p>
<ul class="simple">
<li><p><em>T</em> : any supported numeric type.</p></li>
<li><p><em>T_SIZE</em> : any supported integer type.</p></li>
<li><p><em>T_SCALES</em> : any supported floating-point type.</p></li>
<li><p><em>T_AXES</em> : any supported integer type.</p></li>
</ul>
<p><strong>Detailed description</strong> Calculations are performed according to the following rules.</p>
<div class="highlight"><div class="highlight"><pre><span></span><span class="n">import</span> <span class="n">math</span>
<span class="n">import</span> <span class="n">numpy</span> <span class="n">as</span> <span class="n">np</span>
<span class="n">from</span> <span class="k">enum</span> <span class="n">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">unique</span>

<span class="k">class</span> <span class="nl">GetNearestPixel</span><span class="p">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nl">mode</span><span class="p">:</span> <span class="n">str</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">func</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sc">&#39;round_prefer_floor&#39;</span><span class="o">:</span> <span class="n">GetNearestPixel</span><span class="p">.</span><span class="n">prefer_floor_func</span><span class="p">,</span>
            <span class="sc">&#39;round_prefer_ceil&#39;</span><span class="o">:</span> <span class="n">GetNearestPixel</span><span class="p">.</span><span class="n">prefer_ceil_func</span><span class="p">,</span>
            <span class="sc">&#39;floor&#39;</span><span class="o">:</span> <span class="n">GetNearestPixel</span><span class="p">.</span><span class="n">floor_func</span><span class="p">,</span>
            <span class="sc">&#39;ceil&#39;</span><span class="o">:</span> <span class="n">GetNearestPixel</span><span class="p">.</span><span class="n">ceil_func</span><span class="p">,</span>
            <span class="sc">&#39;simple&#39;</span><span class="o">:</span> <span class="n">GetNearestPixel</span><span class="p">.</span><span class="n">simple_func</span>
        <span class="p">}[</span><span class="n">mode</span><span class="p">]</span>

    <span class="n">def</span> <span class="n">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">prefer_floor_func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">if</span> <span class="n">x_original</span> <span class="o">==</span> <span class="kt">int</span><span class="p">(</span><span class="n">x_original</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">:</span>
            <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a8ea383ca6ce01d26eabe1c27a0e1bd37"><span class="std std-ref">round</span></a><span></span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">prefer_ceil_func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a8ea383ca6ce01d26eabe1c27a0e1bd37"><span class="std std-ref">round</span></a><span></span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">floor_func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">ceil_func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">simple_func</span><span class="p">(</span><span class="n">x_original</span><span class="p">,</span> <span class="n">is_downsample</span><span class="p">)</span><span class="o">:</span>
        <span class="k">if</span> <span class="nl">is_downsample</span><span class="p">:</span>
            <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_original</span><span class="p">))</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="k">return</span> <span class="kt">int</span><span class="p">(</span><span class="n">x_original</span><span class="p">)</span>


<span class="k">class</span> <span class="nl">GetOriginalCoordinate</span><span class="p">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nl">mode</span><span class="p">:</span> <span class="n">str</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">func</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sc">&#39;half_pixel&#39;</span><span class="o">:</span> <span class="n">GetOriginalCoordinate</span><span class="p">.</span><span class="n">half_pixel_func</span><span class="p">,</span>
            <span class="sc">&#39;pytorch_half_pixel&#39;</span><span class="o">:</span> <span class="n">GetOriginalCoordinate</span><span class="p">.</span><span class="n">pytorch_half_pixel_func</span><span class="p">,</span>
            <span class="sc">&#39;asymmetric&#39;</span><span class="o">:</span> <span class="n">GetOriginalCoordinate</span><span class="p">.</span><span class="n">asymmetric_func</span><span class="p">,</span>
            <span class="sc">&#39;tf_half_pixel_for_nn&#39;</span><span class="o">:</span> <span class="n">GetOriginalCoordinate</span><span class="p">.</span><span class="n">tf_half_pixel_for_nn_func</span><span class="p">,</span>
            <span class="sc">&#39;align_corners&#39;</span><span class="o">:</span> <span class="n">GetOriginalCoordinate</span><span class="p">.</span><span class="n">align_corners_func</span>
        <span class="p">}[</span><span class="n">mode</span><span class="p">]</span>

    <span class="n">def</span> <span class="n">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">half_pixel_func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="p">((</span><span class="n">x_resized</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_scale</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">pytorch_half_pixel_func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_resized</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_scale</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="k">if</span> <span class="n">length_resized</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="mf">0.0</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">asymmetric_func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">x_resized</span> <span class="o">/</span> <span class="n">x_scale</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">tf_half_pixel_for_nn_func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_resized</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">x_scale</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">align_corners_func</span><span class="p">(</span><span class="n">x_resized</span><span class="p">,</span> <span class="n">x_scale</span><span class="p">,</span> <span class="n">length_resized</span><span class="p">,</span> <span class="n">length_original</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span>  <span class="mi">0</span> <span class="k">if</span> <span class="n">length_resized</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span>  <span class="n">x_resized</span> <span class="err">\</span><span class="o">*</span> <span class="p">(</span><span class="n">length_original</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">length_resized</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">def</span> <span class="n">get_cubic_coeff</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">:</span>
    <span class="n">abs_s</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">coeff</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">coeff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span> <span class="err">\</span><span class="o">*</span> <span class="p">(</span><span class="n">abs_s</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="err">\</span><span class="o">*</span> <span class="p">(</span><span class="n">abs_s</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span>
    <span class="n">coeff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="mf">2.0</span><span class="p">)</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">))</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="o">+</span> <span class="mf">1.0</span>
    <span class="n">coeff</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(((</span><span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">)</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span><span class="o">+</span> <span class="p">(</span><span class="mf">2.0</span> <span class="err">\</span><span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">3.0</span><span class="p">))</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span>
    <span class="n">coeff</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">a</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="err">\</span><span class="o">*</span> <span class="n">abs_s</span> <span class="err">\</span><span class="o">*</span> <span class="p">(</span><span class="n">abs_s</span> <span class="o">-</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">coeff</span>


<span class="n">def</span> <span class="n">triangle_coeffs</span><span class="p">(</span><span class="n">dz</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">maximum</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dz</span><span class="p">))</span>


<span class="err">@</span><span class="n">unique</span>
<span class="k">class</span> <span class="n">ShapeCalculationMode</span><span class="p">(</span><span class="n">Enum</span><span class="p">)</span><span class="o">:</span>
    <span class="n">SIZES</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">SCALES</span> <span class="o">=</span> <span class="mi">1</span>


<span class="k">class</span> <span class="nl">InterpolateCalculation</span><span class="p">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="nl">attrs</span><span class="p">:</span> <span class="n">dict</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">[</span><span class="sc">&#39;mode&#39;</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">func</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sc">&#39;nearest&#39;</span><span class="o">:</span> <span class="n">self</span><span class="p">.</span><span class="n">nearest_interpolation</span><span class="p">,</span>
            <span class="sc">&#39;linear&#39;</span><span class="o">:</span> <span class="n">self</span><span class="p">.</span><span class="n">linear_interpolation</span><span class="p">,</span>
            <span class="sc">&#39;cubic&#39;</span><span class="o">:</span> <span class="n">self</span><span class="p">.</span><span class="n">cubic_interpolation</span><span class="p">,</span>
            <span class="sc">&#39;linear_onnx&#39;</span><span class="o">:</span> <span class="n">self</span><span class="p">.</span><span class="n">onnx_linear_interpolation</span>
        <span class="p">}[</span><span class="n">self</span><span class="p">.</span><span class="n">mode</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span>

        <span class="n">self</span><span class="p">.</span><span class="n">pads_begin</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;pads_begin&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pads_end</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;pads_end&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">self</span><span class="p">.</span><span class="n">coordinate_transformation_mode</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;coordinate_transformation_mode&#39;</span><span class="p">,</span> <span class="sc">&#39;half_pixel&#39;</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">nearest_mode</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;nearest_mode&#39;</span><span class="p">,</span> <span class="sc">&#39;round_prefer_floor&#39;</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cube_coeff</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;cube_coeff&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.75</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">antialias</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="sc">&#39;antialias&#39;</span><span class="p">,</span> <span class="n">False</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">shape_calculation_mode</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sc">&#39;sizes&#39;</span><span class="o">:</span> <span class="n">ShapeCalculationMode</span><span class="p">.</span><span class="n">SIZES</span><span class="p">,</span>
            <span class="sc">&#39;scales&#39;</span><span class="o">:</span> <span class="n">ShapeCalculationMode</span><span class="p">.</span><span class="n">SCALES</span>
        <span class="p">}[</span><span class="n">attrs</span><span class="p">[</span><span class="sc">&#39;shape_calculation_mode&#39;</span><span class="p">]]</span>

        <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_coordinate_transformation_mode</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">get_nearest_pixel</span> <span class="o">=</span> <span class="n">GetNearestPixel</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">nearest_mode</span><span class="p">)</span>


    <span class="n">def</span> <span class="n">get_coordinate_transformation_mode</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">GetOriginalCoordinate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">coordinate_transformation_mode</span><span class="p">)</span>

    <span class="n">def</span> <a class="reference internal" href="../api/groups/namespaceov_1_1op_1_1v3.html#doxid-namespaceov-1-1op-1-1v3-1a39314e1c3b31ea2b0012eeb30c1c36a8"><span class="std std-ref">shape_infer</span></a><span></span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span><span class="o">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">.</span><span class="n">shape</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">pads_begin</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">pads_end</span>

        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">shape_calculation_mode</span> <span class="o">==</span> <span class="n">ShapeCalculationMode</span><span class="p">.</span><span class="nl">SIZES</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">sizes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">result</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">correct_pad</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">rank</span><span class="p">)</span><span class="o">:</span>
        <span class="n">pad_len</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pad_len</span> <span class="o">&lt;</span> <span class="nl">rank</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">pad</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">rank</span> <span class="o">-</span> <span class="n">pad_len</span><span class="p">),</span> <span class="sc">&#39;constant&#39;</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">elif</span> <span class="n">pad_len</span> <span class="o">&gt;</span> <span class="nl">rank</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">pad</span><span class="p">[</span><span class="o">:</span> <span class="n">rank</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">pad</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">__call__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">scales</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span><span class="o">:</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">.</span><span class="n">ndim</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pads_begin</span> <span class="o">=</span> <span class="n">InterpolateCalculation</span><span class="p">.</span><span class="n">correct_pad</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pads_begin</span><span class="p">,</span> <span class="n">rank</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pads_end</span> <span class="o">=</span> <span class="n">InterpolateCalculation</span><span class="p">.</span><span class="n">correct_pad</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pads_end</span><span class="p">,</span> <span class="n">rank</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pads</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">pads_begin</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">pads_end</span><span class="p">))</span>
        <span class="n">self</span><span class="p">.</span><span class="n">axes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">axes</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">shape_infer</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">sizes</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span>
        <span class="n">padded_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">pad</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">pads</span><span class="p">,</span> <span class="sc">&#39;constant&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">shape_calculation_mode</span> <span class="o">==</span> <span class="n">ShapeCalculationMode</span><span class="p">.</span><span class="nl">SIZES</span><span class="p">:</span>
            <span class="n">num_of_axes</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">scales</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_axes</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">/</span> <span class="n">padded_data</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">scales</span> <span class="o">=</span> <span class="n">scales</span>

        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">mode</span> <span class="o">==</span> <span class="sc">&#39;nearest&#39;</span><span class="o">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">all_scales</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="n">rank</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">all_scales</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span> <span class="o">=</span> <span class="n">padded_data</span><span class="p">.</span><span class="n">shape</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">func</span><span class="p">(</span><span class="n">padded_data</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">clip_coord</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">def</span> <span class="n">cubic_interpolation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>
        <span class="n">num_of_axes</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">ind</span> <span class="k">for</span> <span class="n">ind</span> <span class="n">in</span> <span class="n">np</span><span class="p">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">tuple</span><span class="p">(</span><span class="mi">4</span> <span class="k">for</span> <span class="n">_</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="n">num_of_axes</span><span class="p">)))]</span>
        <span class="k">for</span> <span class="n">coordinates</span> <span class="n">in</span> <span class="n">np</span><span class="p">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">tuple</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">))</span><span class="o">:</span>
            <span class="n">input_coords</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="n">cubic_coeffs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rank</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">in_coord</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
                <span class="n">in_coord_int</span> <span class="o">=</span> <span class="n">math</span><span class="p">.</span><span class="n">floor</span><span class="p">(</span><span class="n">in_coord</span><span class="p">)</span>
                <span class="n">input_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_coord_int</span>
                <span class="n">cubic_coeffs</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_cubic_coeff</span><span class="p">(</span><span class="n">in_coord</span> <span class="o">-</span> <span class="n">in_coord_int</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">cube_coeff</span><span class="p">)</span>
            <span class="n">summa</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">index</span> <span class="n">in</span> <span class="nl">indices</span><span class="p">:</span>
                <span class="n">coords_for_sum</span> <span class="o">=</span> <span class="n">input_coords</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">coeffs_prod</span> <span class="o">=</span> <span class="mf">1.0</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                    <span class="n">coords_for_sum</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">clip_coord</span><span class="p">(</span><span class="n">input_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">+</span> <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                    <span class="n">coeffs_prod</span> <span class="o">=</span> <span class="n">coeffs_prod</span> <span class="err">\</span><span class="o">*</span> <span class="n">cubic_coeffs</span><span class="p">[</span><span class="n">axis</span><span class="p">][</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">summa</span> <span class="o">+=</span> <span class="n">coeffs_prod</span> <span class="err">\</span><span class="o">*</span> <span class="n">input_data</span><span class="p">[</span><span class="n">tuple</span><span class="p">(</span><span class="n">coords_for_sum</span><span class="p">)]</span>
            <span class="n">result</span><span class="p">[</span><span class="n">coordinates</span><span class="p">]</span> <span class="o">=</span> <span class="n">summa</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="n">def</span> <span class="n">linear_interpolation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>
        <span class="n">num_of_axes</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">is_downsample</span> <span class="o">=</span> <span class="n">False</span>

        <span class="k">for</span> <span class="n">scale</span> <span class="n">in</span> <span class="n">self</span><span class="p">.</span><span class="nl">scales</span><span class="p">:</span>
            <span class="n">is_downsample</span> <span class="o">=</span> <span class="n">is_downsample</span> <span class="n">or</span> <span class="p">(</span><span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">antialias</span> <span class="o">=</span> <span class="n">is_downsample</span> <span class="n">and</span> <span class="n">self</span><span class="p">.</span><span class="n">antialias</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_axes</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
            <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">antialias</span> <span class="k">else</span> <span class="mf">1.0</span>

        <span class="n">prod_of_a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">prod</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_axes</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
            <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="k">else</span> <span class="kt">int</span><span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="n">ceil</span><span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

        <span class="n">indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">tuple</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">ind</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">ind</span> <span class="n">in</span> <span class="n">np</span><span class="p">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">tuple</span><span class="p">(</span><span class="mi">2</span> <span class="err">\</span><span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))]</span>

        <span class="k">for</span> <span class="n">coordinates</span> <span class="n">in</span> <span class="n">np</span><span class="p">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">tuple</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">))</span><span class="o">:</span>
            <span class="n">icoords</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="n">icoords_r</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                <span class="n">in_coord</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
                <span class="n">icoords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_coord</span>
                <span class="n">icoords_r</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a8ea383ca6ce01d26eabe1c27a0e1bd37"><span class="std std-ref">round</span></a><span></span><span class="p">(</span><span class="n">in_coord</span><span class="p">)</span>

            <span class="n">summa</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">wsum</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="k">for</span> <span class="n">index</span> <span class="n">in</span> <span class="nl">indices</span><span class="p">:</span>
                <span class="n">inner_coords</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                    <span class="n">inner_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">icoords_r</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

                <span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="n">inner_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="n">and</span> <span class="n">inner_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="k">for</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">not</span> <span class="n">all</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="o">:</span>
                    <span class="k">continue</span>

                <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_of_axes</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axis</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span><span class="o">:</span>
                    <span class="n">dz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">icoords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="n">inner_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span>

                <span class="n">w</span> <span class="o">=</span> <span class="n">prod_of_a</span> <span class="err">\</span><span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">prod</span><span class="p">(</span><span class="n">triangle_coeffs</span><span class="p">(</span><span class="n">a</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz</span><span class="p">))</span>
                <span class="n">wsum</span> <span class="o">+=</span> <span class="n">w</span>
                <span class="n">summa</span> <span class="o">+=</span> <span class="n">w</span> <span class="err">\</span><span class="o">*</span> <span class="n">input_data</span><span class="p">[</span><span class="n">tuple</span><span class="p">(</span><span class="n">inner_coords</span><span class="p">)]</span>

            <span class="k">if</span> <span class="n">wsum</span> <span class="o">==</span> <span class="mi">0</span><span class="o">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">coordinates</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="o">:</span>
                <span class="n">result</span><span class="p">[</span><span class="n">coordinates</span><span class="p">]</span> <span class="o">=</span> <span class="n">summa</span> <span class="o">/</span> <span class="n">wsum</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="n">def</span> <span class="n">onnx_linear_interpolation5D</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">)</span>
        <span class="n">assert</span> <span class="n">rank</span> <span class="n">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s">&quot;mode &#39;linear_onnx&#39; supports only 3D or 5D tensors&quot;</span>
        <span class="n">assert</span> <span class="n">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">}</span> <span class="n">or</span> <span class="n">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">},</span> \
            <span class="s">&quot;mode &#39;linear_onnx&#39; supports only case when axes = {2, 3, 4} or axes = {0, 1, 2}&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">3</span><span class="o">:</span>
            <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">input_data</span>

        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">reshaped_data</span><span class="p">.</span><span class="n">shape</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">output_shape</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">shape</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">num_channels</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">input_depth</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">input_height</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="n">input_width</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
        <span class="n">output_depth</span> <span class="o">=</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">output_height</span> <span class="o">=</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
        <span class="n">output_width</span> <span class="o">=</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>

        <span class="n">depth_scale</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
        <span class="n">height_scale</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="n">width_scale</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

        <span class="n">z_original</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_depth</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">y_original</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">x_original</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="n">in_z1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_depth</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_z2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_depth</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_y1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_y2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">dz1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_depth</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">dz2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_depth</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="n">dy1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">dy2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="n">dx1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">z</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_depth</span><span class="p">)</span><span class="o">:</span>
            <span class="n">in_z</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">depth_scale</span><span class="p">,</span> <span class="n">output_depth</span><span class="p">,</span> <span class="n">input_depth</span><span class="p">)</span>
            <span class="n">z_original</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_z</span>
            <span class="n">in_z</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_z</span><span class="p">,</span> <span class="n">input_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="n">in_z</span><span class="p">),</span> <span class="n">input_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">input_depth</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_z</span> <span class="o">-</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">])</span>
            <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_z</span> <span class="o">-</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span><span class="o">:</span>
                <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="k">for</span> <span class="n">y</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_height</span><span class="p">)</span><span class="o">:</span>
            <span class="n">in_y</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">height_scale</span><span class="p">,</span> <span class="n">output_height</span><span class="p">,</span> <span class="n">input_height</span><span class="p">)</span>
            <span class="n">y_original</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_y</span>
            <span class="n">in_y</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_y</span><span class="p">,</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="n">in_y</span><span class="p">),</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_y</span> <span class="o">-</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
            <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_y</span> <span class="o">-</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">:</span>
                <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_width</span><span class="p">)</span><span class="o">:</span>
            <span class="n">in_x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">width_scale</span><span class="p">,</span> <span class="n">output_width</span><span class="p">,</span> <span class="n">input_width</span><span class="p">);</span>
            <span class="n">x_original</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_x</span>
            <span class="n">in_x</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>

            <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

            <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_x</span> <span class="o">-</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
            <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_x</span> <span class="o">-</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
            <span class="k">if</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">:</span>
                <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="k">for</span> <span class="n">n</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_channels</span><span class="p">)</span><span class="o">:</span>
                <span class="k">for</span> <span class="n">z</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_depth</span><span class="p">)</span><span class="o">:</span>
                    <span class="k">for</span> <span class="n">y</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_height</span><span class="p">)</span><span class="o">:</span>
                        <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_width</span><span class="p">)</span><span class="o">:</span>
                            <span class="n">x111</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x211</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x121</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x221</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z1</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x112</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x212</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x122</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                            <span class="n">x222</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_z2</span><span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>

                            <span class="n">temp</span> <span class="o">=</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x111</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x211</span>
                            <span class="n">temp</span> <span class="o">+=</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x121</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz2</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x221</span>
                            <span class="n">temp</span> <span class="o">+=</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x112</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x212</span>
                            <span class="n">temp</span> <span class="o">+=</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x122</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dz1</span><span class="p">[</span><span class="n">z</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x222</span>

                            <span class="n">result</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">onnx_linear_interpolation4D</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">)</span>
        <span class="n">assert</span> <span class="n">rank</span> <span class="n">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s">&quot;mode &#39;linear_onnx&#39; supports only 2D or 4D tensors&quot;</span>
        <span class="n">assert</span> <span class="n">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">}</span> <span class="n">or</span> <span class="n">set</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> \
            <span class="s">&quot;mode &#39;linear_onnx&#39; supports only case when axes = {2, 3} or axes = {0, 1}&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">rank</span> <span class="o">==</span> <span class="mi">2</span><span class="o">:</span>
            <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">input_data</span>

        <span class="n">input_shape</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">reshaped_data</span><span class="p">.</span><span class="n">shape</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">output_shape</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">shape</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">output_height</span> <span class="o">=</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">output_width</span> <span class="o">=</span> <span class="n">output_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">input_height</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">input_width</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">height_scale</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">width_scale</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scales</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">batch_size</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">num_channels</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">y_original</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">x_original</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="n">in_y1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_y2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_x1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
        <span class="n">in_x2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>

        <span class="n">dy1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">dy2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_height</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="n">dx1</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>
        <span class="n">dx2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">output_width</span><span class="p">).</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="kt">float</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">y</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_height</span><span class="p">)</span><span class="o">:</span>
            <span class="n">in_y</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">height_scale</span><span class="p">,</span> <span class="n">output_height</span><span class="p">,</span> <span class="n">input_height</span><span class="p">)</span>
            <span class="n">y_original</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_y</span>
            <span class="n">in_y</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_y</span><span class="p">,</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="kt">int</span><span class="p">(</span><span class="n">in_y</span><span class="p">),</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">input_height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_y</span> <span class="o">-</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>
            <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_y</span> <span class="o">-</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">])</span>

            <span class="k">if</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span><span class="o">:</span>
                <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_width</span><span class="p">)</span><span class="o">:</span>
            <span class="n">in_x</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">width_scale</span><span class="p">,</span> <span class="n">output_width</span><span class="p">,</span> <span class="n">input_width</span><span class="p">);</span>
            <span class="n">x_original</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">in_x</span>
            <span class="n">in_x</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">));</span>

            <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">input_width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

            <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_x</span> <span class="o">-</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
            <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1af17e259120922e6ffb66ac8961a74256"><span class="std std-ref">abs</span></a><span></span><span class="p">(</span><span class="n">in_x</span> <span class="o">-</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
            <span class="k">if</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">:</span>
                <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
                <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

        <span class="k">for</span> <span class="n">n</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_channels</span><span class="p">)</span><span class="o">:</span>
                <span class="k">for</span> <span class="n">y</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_height</span><span class="p">)</span><span class="o">:</span>
                    <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1ad38dec78131946cded583cc1154a406d"><span class="std std-ref">range</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_width</span><span class="p">)</span><span class="o">:</span>
                        <span class="n">x11</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                        <span class="n">x21</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_y1</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                        <span class="n">x12</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x1</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                        <span class="n">x22</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">in_y2</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">in_x2</span><span class="p">[</span><span class="n">x</span><span class="p">]]</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x11</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy2</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x21</span> <span class="o">+</span> <span class="n">dx2</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x12</span> <span class="o">+</span> <span class="n">dx1</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">dy1</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> <span class="err">\</span><span class="o">*</span> <span class="n">x22</span>
                        <span class="n">result</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>

        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">onnx_linear_interpolation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">rank</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">)</span>
        <span class="n">assert</span> <span class="n">rank</span> <span class="n">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s">&quot;mode &#39;linear_onnx&#39; supports only 2D, 3D, 4D, or 5D tensors&quot;</span>

        <span class="k">if</span> <span class="n">rank</span> <span class="n">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span><span class="o">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">onnx_linear_interpolation4D</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
        <span class="k">else</span><span class="o">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">onnx_linear_interpolation5D</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">nearest_interpolation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">)</span><span class="o">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">)</span>

        <span class="n">num_of_axes</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">coordinates</span> <span class="n">in</span> <span class="n">np</span><span class="p">.</span><span class="n">ndindex</span><span class="p">(</span><span class="n">tuple</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">))</span><span class="o">:</span>
            <span class="n">input_coords</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">axis</span><span class="p">,</span> <span class="n">scale</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">all_scales</span><span class="p">)</span><span class="o">:</span>
                <span class="n">in_coord</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_original_coordinate</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">scale</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">output_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">],</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">])</span>
                <span class="n">nearest_pixel</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">get_nearest_pixel</span><span class="p">(</span><span class="n">in_coord</span><span class="p">,</span> <span class="n">scale</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">input_coords</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1a92cfabd79e866544fb35d44884e7adfd"><span class="std std-ref">max</span></a><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a class="reference internal" href="../api/groups/namespacengraph_1_1runtime_1_1reference.html#doxid-namespacengraph-1-1runtime-1-1reference-1abc42885cb896b121ab5ac214cbf60935"><span class="std std-ref">min</span></a><span></span><span class="p">(</span><span class="n">nearest_pixel</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">input_shape</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">result</span><span class="p">[</span><span class="n">coordinates</span><span class="p">]</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">tuple</span><span class="p">(</span><span class="n">input_coords</span><span class="p">)]</span>

        <span class="k">return</span> <span class="n">result</span></pre></div></div><p><strong>Example</strong></p>
<div class="highlight"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">layer</span> <span class="p">...</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;Interpolate&quot;</span> <span class="p">...</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">data</span> <span class="n">shape_calculation_mode</span><span class="o">=</span><span class="s">&quot;scales&quot;</span> <span class="n">pads_begin</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="n">pads_end</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="n">mode</span><span class="o">=</span><span class="s">&quot;linear&quot;</span><span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">input</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">port</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;0&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">48</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">80</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">port</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;1&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>  <span class="o">&lt;!--</span><span class="n">The</span> <span class="n">values</span> <span class="n">in</span> <span class="k">this</span> <span class="n">input</span> <span class="n">are</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">160</span><span class="p">]</span> <span class="o">--&gt;</span>
        <span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">port</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;2&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>  <span class="o">&lt;!--</span><span class="n">The</span> <span class="n">values</span> <span class="n">in</span> <span class="k">this</span> <span class="n">input</span> <span class="n">are</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]</span> <span class="o">--&gt;</span>
        <span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">port</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;3&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>  <span class="o">&lt;!--</span><span class="n">The</span> <span class="n">values</span> <span class="n">in</span> <span class="k">this</span> <span class="n">input</span> <span class="n">are</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="p">(</span><span class="n">axes</span><span class="p">).</span> <span class="o">--&gt;</span>
        <span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">input</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">output</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">port</span> <span class="n">id</span><span class="o">=</span><span class="s">&quot;0&quot;</span>  <span class="n">precision</span><span class="o">=</span><span class="s">&quot;FP32&quot;</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">24</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">dim</span><span class="o">&gt;</span><span class="mi">160</span><span class="o">&lt;/</span><span class="n">dim</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">port</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">output</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">layer</span><span class="o">&gt;</span></pre></div></div></section>


                </div>
            
            
                <div class='prev-next-bottom'>
                  
    <a class='button bttn-sec button-size-l' id="prev-link" href="openvino_docs_ops_image_Interpolate_1.html" title="previous page">Prev</a>
    <a class='button bttn-sec button-size-l' id="next-link" href="openvino_docs_ops_normalization_LRN_1.html" title="next page">Next</a>

                </div>
            
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Intel®.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>